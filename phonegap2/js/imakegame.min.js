$(document).ready(function(){function V(){location.href=j.attr("next-level")}var a=$("#scene"),b=$("#hero"),c=$(".floor"),d=$("#bg"),e=$(".enemy"),f=$(".bonus"),g=$("#bullet"),h=$("#end"),i=$("#gamepad"),j=$("#finish");$("body").append('<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">'),a.width(a.attr("width")).height(a.attr("height")),i.append('<div class="btn-arrow up"><i class="fa fa-chevron-up" aria-hidden="true"></i></div><div class="btn-arrow down"><i class="fa fa-chevron-down" aria-hidden="true"></i></div><div class="btn-arrow right"><i class="fa fa-chevron-right" aria-hidden="true"></i></div><div class="btn-arrow left"><i class="fa fa-chevron-left" aria-hidden="true"></i></div><div class="btn-action jump"></div><div class="btn-action fire"></div>'),d.css({width:"300%",height:"100%",background:"url("+d.attr("src")+") repeat-x",backgroundSize:"auto 100%"}),g.hide(),g.css({width:g.attr("width"),height:g.attr("height"),background:"url("+g.attr("bg")+") repeat-x",backgroundSize:"auto 100%"});var k=a.width()/2-100,l=b.attr("position").split(",");b.width(b.attr("width")).height(b.attr("height")),b.css({top:parseInt(l[0]),left:parseInt(l[1])});var m=j.attr("position").split(",");j.width(j.attr("width")).height(j.attr("height")),j.css({top:parseInt(m[0]),left:parseInt(m[1]),background:"url("+j.attr("bg")+") no-repeat",backgroundSize:"auto 100%"});for(var m,n=0;n<c.length;n++)m=c.eq(n).attr("position").split(","),c.eq(n).width(c.eq(n).attr("width")).height(c.eq(n).attr("height")),c.eq(n).css({top:parseInt(m[0]),left:parseInt(m[1]),background:"url("+c.eq(n).attr("bg")+") repeat-x",backgroundSize:"auto 100%"});for(var o,p=[],q=[],n=0;n<e.length;n++)o=e.eq(n).attr("position").split(","),e.eq(n).width(e.eq(n).attr("width")).height(e.eq(n).attr("height")),e.eq(n).css({top:parseInt(o[0]),left:parseInt(o[1]),background:"url("+e.eq(n).attr("bg")+") repeat-x",backgroundSize:"auto 100%"}),p[n]=!1,q[n]=!1;for(var r,n=0;n<f.length;n++)r=f.eq(n).attr("position").split(","),f.eq(n).width(f.eq(n).attr("width")).height(f.eq(n).attr("height")),f.eq(n).css({top:parseInt(r[0]),left:parseInt(r[1]),background:"url("+f.eq(n).attr("bg")+") repeat-x",backgroundSize:"auto 100%"}),p[n]=!1,q[n]=!1;var s=!0,t=!0,u=!1,v=!1,w=!1,x=!1,y=!1,z=!1,A=!0,B=[],C=[],D=[],E=7,F=3,G=[],H=2,I=!1,J="right",K=50,L=!1,M=3,N=!1,O=0,P=!0,Q=!1;b.attr("life")&&(M=parseInt(b.attr("life"))),$("#life span").text(M),$("#score span").text(O),"true"==a.attr("automove")&&(L=!0),b.attr("speed")&&(E=parseInt(b.attr("speed"))),"true"==b.attr("multi-jump")?Q=!0:"false"==b.attr("multi-jump")&&(Q=!1),g.attr("speed")&&(K=parseInt(g.attr("speed"))),"false"==b.attr("shoot")&&(P=!1),d.attr("speed")&&(H=d.attr("speed")),"false"==b.attr("gravity")&&(s=!1,t=!1);for(var R=b.offset().top,S=R-130,n=0;n<e.length;n++)B[n]="left",C[n]=e.eq(n).attr("road").split(","),D[n]=e.eq(n).attr("mortal"),e.eq(n).attr("speed")?G[n]=e.eq(n).attr("speed"):G[n]=F;var T=parseInt(l[1]),U={init:function(){if(U.gravity(),1==t?U.floorCollision():x=!0,console.log(z),U.enemyRoad(),U.enemyCollision(),U.bonusCollision(),U.firing(),U.bulletCollision(),U.sceneOut(),U.finishCollision(),0==u&&0==v&&1==A&&b.css({background:"url("+b.attr("bg")+")",backgroundSize:"auto 100%"}),0==L)if(1==u&&0==v)if(b.css({background:"url("+b.attr("bg-move")+")",backgroundSize:"auto 100%",transform:"rotateY(0deg)"}),T<=k)T+=parseInt(E),b.css({left:T});else{for(var g=0;g<c.length;g++)c.eq(g).css({left:c.eq(g).offset().left-a.offset().left-E});for(var g=0;g<f.length;g++)f.eq(g).css({left:f.eq(g).offset().left-a.offset().left-E});j.css({left:j.offset().left-a.offset().left-E});for(var g=0;g<e.length;g++)C[g][0]-=6,C[g][1]-=6,e.eq(g).css({left:e.eq(g).offset().left-a.offset().left-E});d.offset().left+d.width()>a.offset().left+a.width()?d.css({left:d.offset().left-a.offset().left-H}):(d.css({left:a.offset().left-a.width()}),d.css({left:d.offset().left-a.offset().left-H}))}else 1==v&&0==u&&(b.css({background:"url("+b.attr("bg-move")+")",backgroundSize:"auto 100%",transform:"rotateY(180deg)"}),T-=E,b.css({left:T}));else{for(var g=0;g<c.length;g++)c.eq(g).css({left:c.eq(g).offset().left-a.offset().left-E});for(var g=0;g<f.length;g++)f.eq(g).css({left:f.eq(g).offset().left-a.offset().left-E});for(var g=0;g<e.length;g++)C[g][0]-=6,C[g][1]-=6,e.eq(g).css({left:e.eq(g).offset().left-a.offset().left-E});d.offset().left+d.width()>a.offset().left+a.width()?d.css({left:d.offset().left-a.offset().left-H}):(d.css({left:a.offset().left-a.width()}),d.css({left:d.offset().left-a.offset().left-H}))}1==w&&b.css({top:b.offset().top-a.offset().top-E}),1==y&&b.css({top:b.offset().top-a.offset().top+E});for(var g=0;g<e.length;g++)"left"==B[g]?e.eq(g).css({left:e.eq(g).offset().left-a.offset().left-parseInt(G[g]),transform:"rotateY(0deg)"}):"right"==B[g]&&e.eq(g).css({left:e.eq(g).offset().left-a.offset().left+parseInt(G[g]),transform:"rotateY(180deg)"});b.offset().top>=S&&1==z?(s=!1,b.css({top:b.offset().top-30,left:T})):z=!1,0==N&&setTimeout(U.init,30)},gravity:function(){return 1==s&&void b.css({top:b.offset().top+1})},enemyRoad:function(){for(var b=0;b<e.length;b++)e.eq(b).offset().left-a.offset().left<=C[b][0]?B[b]="right":e.eq(b).offset().left-a.offset().left>=C[b][1]&&(B[b]="left")},floorCollision:function(){for(var d=0;d<c.length;d++){if(b.offset().left+b.width()>c.eq(d).offset().left&&b.offset().left<c.eq(d).offset().left+c.eq(d).width()&&b.offset().top+b.height()>=c.eq(d).offset().top-1&&b.offset().top<c.eq(d).offset().top+1&&p.indexOf(!0)==-1){s=!1,b.css({top:c.eq(d).offset().top-a.offset().top-b.height()}),x=!0;break}s=!0,x=0!=Q}},bonusCollision:function(){for(var a=0;a<f.length;a++)b.offset().left+b.width()>f.eq(a).offset().left&&b.offset().left<f.eq(a).offset().left+f.eq(a).width()&&b.offset().top+b.height()>=f.eq(a).offset().top-1&&b.offset().top<f.eq(a).offset().top+1&&(f.eq(a).hide(),$("audio#get-bonus")[0]&&($("audio#get-bonus")[0].pause(),$("audio#get-bonus")[0].currentTime=0,$("audio#get-bonus")[0].play()),O+=10,$("#score span").text(O))},finishCollision:function(){b.offset().left+b.width()>j.offset().left&&($("audio#level")[0]&&$("audio#level-clear")[0]&&($("audio#level")[0].pause(),$("audio#level")[0].currentTime=0,$("audio#level-clear")[0].play()),A=!0,v=!1,u=!1,setTimeout(V,3e3))},enemyCollision:function(){for(var a=0;a<e.length;a++)D[a]&&"false"==D[a]?(b.offset().left+b.width()>e.eq(a).offset().left&&b.offset().left<e.eq(a).offset().left+e.eq(a).width()&&b.offset().top+b.height()>=e.eq(a).offset().top-1&&b.offset().top<e.eq(a).offset().top+e.eq(a).height()&&0==q[a]||1==p[a])&&(b.css({transform:"rotateX(180deg)"}),s=!0,p[a]=!0,$("audio#level")[0]&&$("audio#hero-died")[0]&&($("audio#level")[0].pause(),$("audio#level")[0].currentTime=0,$("audio#hero-died")[0].play())):b.offset().left+b.width()>e.eq(a).offset().left&&b.offset().left<e.eq(a).offset().left+e.eq(a).width()&&b.offset().top+b.height()>=e.eq(a).offset().top+15&&b.offset().top<e.eq(a).offset().top+e.eq(a).height()&&0==q[a]||1==p[a]?(b.css({transform:"rotateX(180deg)"}),s=!0,p[a]=!0,$("audio#level")[0]&&$("audio#hero-died")[0]&&($("audio#level")[0].pause(),$("audio#level")[0].currentTime=0,$("audio#hero-died")[0].play())):(b.offset().left+b.width()>e.eq(a).offset().left&&b.offset().left<e.eq(a).offset().left+e.eq(a).width()&&b.offset().top+b.height()<=e.eq(a).offset().top+15&&b.offset().top+b.height()>=e.eq(a).offset().top&&0==q[a]||1==p[a])&&(q[a]=!0,e.eq(a).css({background:"url("+e.eq(a).attr("bg-kill")+") no-repeat",backgroundSize:"auto 100%"}).fadeOut(1e3),$("audio#enemy-died")[0]&&$("audio#enemy-died")[0].play(),z=!0,R=b.offset().top,S=R-130)},bulletCollision:function(){if(g.length>0)for(var a=0;a<e.length;a++)g.offset().left+g.width()>e.eq(a).offset().left&&g.offset().left<e.eq(a).offset().left+e.eq(a).width()&&g.offset().top+g.height()>=e.eq(a).offset().top-1&&g.offset().top<e.eq(a).offset().top+e.eq(a).height()&&0==q[a]&&(q[a]=!0,e.eq(a).css({background:"url("+e.eq(a).attr("bg-kill")+") no-repeat",backgroundSize:"auto 100%"}).fadeOut(1e3),$("audio#enemy-died")[0]&&$("audio#enemy-died")[0].play(),g.hide(),I=!1)},firing:function(){1==I?(g.show(),"right"==J?g.css({left:g.offset().left-a.offset().left+K}):"left"==J?g.css({left:g.offset().left-a.offset().left-K}):"top"==J?g.css({top:g.offset().top-a.offset().top-K}):"bottom"==J&&g.css({top:g.offset().top-a.offset().top+K})):g.css({top:b.offset().top-a.offset().top+b.height()/4,left:b.offset().left-a.offset().left})},sceneOut:function(){if(g.length>0&&(g.offset().left<a.offset().left||g.offset().left>a.offset().left+a.width()||g.offset().top<a.offset().top||g.offset().top>a.offset().top+a.height())&&(I=!1,g.hide()),b.offset().left<a.offset().left||b.offset().left>a.offset().left+a.width()||b.offset().top<a.offset().top||b.offset().top>a.offset().top+a.height()){M--,M<=0&&(N=!0,h.show()),$("#life span").text(M),b.css({transform:"rotateX(0deg)"}),$("audio#level")[0]&&$("audio#level")[0].play();for(var d=0;d<c.length;d++)m=c.eq(d).attr("position").split(","),c.eq(d).width(c.eq(d).attr("width")).height(c.eq(d).attr("height")),c.eq(d).css({top:parseInt(m[0]),left:parseInt(m[1]),background:"url("+c.eq(d).attr("bg")+") repeat-x",backgroundSize:"auto 100%"});m=j.attr("position").split(","),j.width(j.attr("width")).height(j.attr("height")),j.css({top:parseInt(m[0]),left:parseInt(m[1]),background:"url("+j.attr("bg")+") no-repeat",backgroundSize:"auto 100%"});for(var d=0;d<e.length;d++)C[d]=e.eq(d).attr("road").split(","),e.eq(d).show(),o=e.eq(d).attr("position").split(","),e.eq(d).width(e.eq(d).attr("width")).height(e.eq(d).attr("height")),e.eq(d).css({top:parseInt(o[0]),left:parseInt(o[1]),background:"url("+e.eq(d).attr("bg")+") repeat-x",backgroundSize:"auto 100%"}),p[d]=!1,q[d]=!1;for(var d=0;d<f.length;d++)f.eq(d).show(),r=f.eq(d).attr("position").split(","),f.eq(d).width(f.eq(d).attr("width")).height(f.eq(d).attr("height")),f.eq(d).css({top:parseInt(r[0]),left:parseInt(r[1]),background:"url("+f.eq(d).attr("bg")+") repeat-x",backgroundSize:"auto 100%"}),p[d]=!1,q[d]=!1;b.css({top:parseInt(l[0]),left:parseInt(l[1])}),T=parseInt(l[1])}}};$("#gamepad .right").bind("mousedown touchstart",function(){u=!0,v=!1,A=!1,0==I&&(J="right")}),$("#gamepad .right").bind("mouseup touchend",function(){u=!1,A=!0}),$("#gamepad .left").bind("mousedown touchstart",function(){v=!0,u=!1,A=!1,0==I&&(J="left")}),$("#gamepad .left").bind("mouseup touchend",function(){v=!1,A=!0}),$("#gamepad .up, #gamepad .jump").bind("mousedown touchstart",function(){1==t?(z=!0,R=b.offset().top,S=R-130,$("audio#jump")[0]&&$("audio#jump")[0].play()):w=!0}),$("#gamepad .up, #gamepad .jump").bind("mouseup touchend",function(){w=!1,A=!0}),$("#gamepad .down").bind("mousedown touchstart",function(){y=!0}),$("#gamepad .down").bind("mouseup touchend",function(){y=!1,A=!0}),$("#gamepad .fire").click(function(){I=!0,$("audio#shoot")[0]&&$("audio#shoot")[0].play()}),$(document).keydown(function(a){console.log(a),68==a.which?(u=!0,v=!1,A=!1,0==I&&(J="right")):65==a.which&&(v=!0,u=!1,A=!1,0==I&&(J="left")),87==a.which&&1==u&&1==x?1==t?(z=!0,R=b.offset().top,S=R-130,$("audio#jump")[0]&&$("audio#jump")[0].play()):w=!0:87==a.which&&1==v&&1==x?1==t?(z=!0,R=b.offset().top,S=R-130,$("audio#jump")[0]&&$("audio#jump")[0].play()):w=!0:87==a.which&&0==u&&0==v&&1==x?(console.log("burada"),1==t?(console.log(x),z=!0,R=b.offset().top,S=R-130,$("audio#jump")[0]&&$("audio#jump")[0].play()):w=!0):83==a.which&&0==t&&(y=!0),13==a.which&&1==P&&(I=!0,$("audio#shoot")[0]&&$("audio#shoot")[0].play())}),$(document).keyup(function(a){68==a.which?(u=!1,A=!0):65==a.which?(v=!1,A=!0):87==a.which?(w=!1,A=!0):83==a.which&&(y=!1,A=!0)}),U.init()});
